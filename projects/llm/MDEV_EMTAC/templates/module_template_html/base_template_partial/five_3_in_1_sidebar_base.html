<div class="five331-partial-template">
  <div class="five331-layout">
    <!-- Sidebar with 2 sections -->
    <div id="five331-sidebar" class="five331-sidebar five331-closed">
      <div class="five331-sidebar-section" id="five331-quick-actions">
        {% block quick_actions %}{% endblock %}
      </div>
      <div class="five331-sidebar-section" id="five331-feedback">
        {% block feedback %}{% endblock %}
      </div>
    </div>

    <!-- Main -->
    <div class="five331-main">
      <!-- Chat -->
      <div class="five331-chat">
        <div class="five331-chat-header">
          <button onclick="five331ToggleSidebar()">☰</button>
          {% block chat_header %}{% endblock %}
        </div>
        <div class="five331-chat-body">
          <div id="five331-chat-area" class="five331-chat-area">
            {% block chat_area %}{% endblock %}
          </div>
          <div class="five331-chat-input">
            {% block chat_input %}
            <textarea id="five331-user_input" placeholder="Type..."></textarea>
            <button id="five331-submit-question" onclick="five331SubmitQuestion()">➤</button>
            {% endblock %}
          </div>
        </div>
      </div>

      <!-- Right side panels -->
      <div class="five331-panels">
        <div class="five331-panel" id="five331-panel-a"><div class="five331-panel-body">{% block panel_a %}{% endblock %}</div></div>
        <div class="five331-panel" id="five331-panel-b"><div class="five331-panel-body">{% block panel_b %}{% endblock %}</div></div>
        <div class="five331-panel" id="five331-panel-c"><div class="five331-panel-body">{% block panel_c %}{% endblock %}</div></div>
        <div class="five331-panel" id="five331-panel-d"><div class="five331-panel-body">{% block panel_d %}{% endblock %}</div></div>
      </div>
    </div>
  </div>
</div>

<style>
  .five331-layout {
    display: flex;
    flex: 1;
    overflow: hidden;
    height: 100%;
  }

  /* Sidebar */
  .five331-sidebar {
    width: 250px;
    background: rgba(255,255,255,0.05);
    border-right: 2px solid #39FF14;
    transition: width 0.3s ease, padding 0.3s ease;
    display: flex;
    flex-direction: column;
    gap: 12px;
    padding: 10px;
  }
  .five331-sidebar.five331-closed {
    width: 0;
    padding: 0;
    overflow: hidden;
    border: none;
  }
  .five331-sidebar-section {
    flex: 1;
    background: rgba(0,0,0,0.2);
    border-radius: 6px;
    padding: 10px;
  }

  /* Main area: chat + panels */
  .five331-main {
    display: grid;
    grid-template-columns: 2fr 1fr;
    flex: 1;
    overflow: hidden;
  }

  /* Chat */
  .five331-chat {
    display: flex;
    flex-direction: column;
    border-right: 1px solid rgba(255,255,255,0.1);
  }
  .five331-chat-header {
    background: rgba(255,255,255,0.1);
    padding: 8px;
    display: flex;
    align-items: center;
    justify-content: flex-start;
    gap: 10px;
  }
  .five331-chat-body {
    display: flex;
    flex-direction: column;
    flex: 1;
  }
  .five331-chat-area {
    flex: 1;
    margin: 8px;
    background: rgba(255,255,255,0.05);
    border-radius: 4px;
    overflow-y: auto;
    padding: 10px;
  }
  .five331-chat-input {
    display: flex;
    gap: 8px;
    margin: 8px;
    background: rgba(255,255,255,0.05);
    border-radius: 4px;
    padding: 6px;
  }
  .five331-chat-input textarea {
    flex: 1;
    resize: none;
    border: none;
    background: transparent;
    color: #eee;
  }
  .five331-chat-input button {
    background: #39FF14;
    border: none;
    border-radius: 4px;
    padding: 6px 12px;
    cursor: pointer;
    font-weight: bold;
    color: black;
  }

  /* Panels */
  .five331-panels {
    display: grid;
    grid-template-rows: repeat(4, 1fr);
    gap: 8px;
    padding: 8px;
  }
  .five331-panel {
    background: rgba(255,255,255,0.05);
    border-radius: 4px;
    display: flex;
    flex-direction: column;
  }
  .five331-panel-body {
    flex: 1;
    padding: 10px;
  }
</style>

<script>
  function five331ToggleSidebar() {
    document.getElementById("five331-sidebar").classList.toggle("five331-closed");
  }
  function five331SubmitQuestion() {
    const input = document.getElementById("five331-user_input");
    const chat = document.getElementById("five331-chat-area");
    if (input && chat && input.value.trim()) {
      chat.innerHTML += `<div><strong>You:</strong> ${input.value}</div>`;
      chat.innerHTML += `<div><strong>AI:</strong> Placeholder response</div>`;
      input.value = "";
      chat.scrollTop = chat.scrollHeight;
    }
  }
</script>
